create or replace FUNCTION NORMDIST(X_VALUE IN number, X_MEAN IN number, X_SIGMA IN number, X_CUMMULATIVE IN number) RETURN number
IS
	X NUMBER;
	Z NUMBER;
	T NUMBER;
	ANS NUMBER;
	RETURNVALUE NUMBER;
BEGIN
	X := (X_VALUE - X_MEAN) / X_SIGMA;
	IF X_CUMMULATIVE = 1 THEN -- VERDADERO
		Z := ABS(X) / SQRT( 2.0 );
		T := 1.0 / (1.0 + 0.5 * Z);
		ANS := T * exp(-Z * Z -1.26551223 + T * (1.00002368 + T * (0.37409196 + T * (0.09678418 + T * (-0.18628806 + T *(0.27886807 + T *(-1.13520398 + T * (1.48851587 + T * (-0.82215223 + T * 0.17087277)))))))))/2.0;
		IF X <= 0 THEN
			RETURNVALUE := ANS;
		ELSE
			RETURNVALUE := 1 - ANS;
		END IF;
	ELSE -- FALSO
		RETURNVALUE := ( 1 / (X_SIGMA * SQRT( 2.0 * 3.14159265358979 ))) * EXP(-((X_VALUE - X_MEAN) * (X_VALUE - X_MEAN)) / (2* (X_SIGMA * X_SIGMA)));
	END IF;
	
	RETURN RETURNVALUE;
	
	EXCEPTION
  		WHEN OTHERS THEN
    			RETURN NULL;	
END;
/
